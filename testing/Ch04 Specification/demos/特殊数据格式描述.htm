<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>新建网页 1</title>
<style>
p, pre {font-size:9pt; line-height:150%}
</style>
</head>

<body>

<p align="center"><b><font size="3">特殊数据格式描述</font></b></p>

<p>本文档包括如下几个部分：</p>

<p><a href="#[系统邮件过滤规则]">系统邮件过滤规则</a><br>
<a href="#[个人邮件过滤规则]">个人邮件过滤规则</a><br>
<a href="#[个人日程安排格式描述]">个人日程安排格式描述</a><br>
<a href="#[日志订阅格式描述]">日志订阅格式描述</a></p>

<hr color="#000000" size="1">

<p><b><a name="[系统邮件过滤规则]">[系统邮件过滤规则]</a></b><br>
A、数据描述<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; <br>
&lt;系统规则&gt;<br>
&lt;规则&gt;邮件级别为低级&lt;/规则&gt;<br>
&lt;/系统规则&gt;<br>
<br>
B、解析算法：<br>
XPATH、SELECT CASE</p>
<hr color="#000000" size="1">
<pre><b><a name="[个人邮件过滤规则]">[个人邮件过滤规则]</a></b>
A、数据格式：
邮件级别为[低/中/高]级
邮件标题包含XX
发件人是XX
（XX可以是任意字符）

B、解析算法：
dim ruler as string
select case left(ruler,4)
	case "邮件级别"
		select case right(ruler,2)
			case "低级"
				'do something
			case "中级"
				'do something
			case "高级"
				'do something
		end select

	case "邮件标题"
		'do something

	case "发件人是"
		'do something
end select</pre>
<hr color="#000000" size="1">

<pre><b><a name="[个人日程安排格式描述]">[个人日程安排格式描述]</a></b>

[外观日程格式描述]
2002-10-18 13:00
每天,13:00
每周的星期一,13:00
每月的第02天,13:00
每年的01月01日,13:00

[数据库日程格式描述]
2002-10-18 13:00	单独日程时间
ey-em-ed 13:00	每天 13:00
ey-em-28 13:00	每月28日 13:00
ey-10-19 13:00	每年10月19日 13:00
ew1/27w2 13:00	每周一 13:00 / 每年第27周的周二

[数据库日程格式描述 补充说明]
ey / em / ed / ew 分别表示 every year / every month / every day / every week
周循环目前仅解析前五个字符，每年指定周的功能留待扩充。
周循环的第五个字符表示第几周。范围 1～7，分别表示周日～周六。当没有超出此范围时，后续五个字符被忽略。
关于为什么“3=周二，7=周六”的原因：多数高级语言都用枚举表示星期，而且惯例把周日放在首位。枚举默认第一个值为 1，所以
导致这种情况。vbscript / vc 均是这种表示方法。javascript 则用 0～6 表示。</pre>

<hr color="#000000" size="1">
<pre><b><a name="[日志订阅格式描述]">[日志订阅格式描述]</a>
</b>
[外观格式举例]
订阅 主机 YW 应用程序日志 错误，ID 为 123、456
过滤 主机 oaserver 系统日志 信息
订阅 所有主机 所有种类日志 所有类型

[数据格式举例]
a /Server:[YW] /Category:[Application] /Type:[Error]
d /Server:[NTSERVER] /Category:[Security] /Type:[Warning] /EventID:[123][456]
a /Server:[OASERVER] /Category:[System] /Type:[Failure] /EventID:[456]

[格式详细解释]
a	允许
d	禁止
/Server:	服务器名字
/Category	事件种类，包括 Application / Security / System
/Type:	事件类型，包括 Error / Warning / Information / AuditSuccess / AuditFailure
/EventID:	事件 ID。<b>仅</b>这一项可以多个项罗列。
如果某一项为空，则表示所有。
不能 Key 存在而 Value 不存在。

[短信发送格式]
[系统日志警报] 主机:NTSERVER 应用程序日志 警告，信息来源：MSSQLSERVER，信息 ID 19011，内容：SuperSocket 信息: (SpnRegister) : Error 1355。</pre>

</body>

</html>                    

                                                                                     
                    
